<!DOCTYPE html>
<html>
  <head>
    <title>Yule Log VR</title>
    <meta name="description" content="Yule Log VR"></meta>
    <script src='../vendor/aframe.min.js'></script>
    <script src='../vendor/aframe-particle-system-component.min.js'></script>
  </head>

  <body>
    <a-scene>
        <a-assets>
            <img id='wood' src='assets/oldwood-diffuse.png' />
            <img id='wood-normal' src='assets/oldwood-normal.png' />
            <img id='stone' src='assets/stone-diffuse-256.png' />
            <img id='stone-normal' src='assets/stone-normal-256.png' />
            <img id='bark' src='assets/bark-diffuse-256.png' />
            <img id='bark-normal' src='assets/bark-normal-256.png' />
            <img id='flame-texture' src='assets/particle.png' />
            <audio id='fire-audio' src='assets/fire.ogg' preload='auto' />
            <audio id='snow-audio' src='assets/snow.ogg' preload='auto' />
            <a-asset-item id='fireplace-obj' src='assets/fireplace.obj' />
            <a-asset-item id='log-obj' src='assets/log.obj' />
            <a-mixin id='wall' scale='2 2 2' material='src: #wood; normalMap: #wood-normal; roughness: 1; metalness: 0, normalScale: 2 2' />
            <a-mixin id='stone-material' material='src: #stone; normalMap: #stone-normal; roughness: 1; metalness: 0, normalScale: 0.5 0.5' />
            <a-mixin id='log-mixin' scale='0.015 0.015 0.015' material='src: #bark; normalMap: #bark-normal; roughness: 1; metalness: 0, normalScale: 1 1' />
        </a-assets>
        <a-camera position='0 -2 2'>
            <a-cursor></a-cursor>
        </a-camera>
        <a-sky color="#111"></a-sky>
        <!-- Snow -->
        <!-- Note we must use non zero values in all vec3's otherwise defaults kick in,
             so use very low values if we want to 'zero' something
             https://github.com/IdeaSpaceVR/aframe-particle-system-component/issues/13 -->
        <a-entity id='snow'
            sound='src: #snow-audio; autoplay: true; loop: true; volume: 0.2'
            position='-2.74 2 -2.3'
            particle-system='texture: #flame-texture;
            color: #ffffff;
            positionSpread: 2 2 4;
            velocityValue: 0.01 -1 0.01;
            velocitySpread: 0.01 2 0.01;
            accelerationValue: 0.1 -5 0.1;
            accelerationSpread: 0.1 -10 1;
            maxAge: 3;
            size: 0.3;
            particleCount: 300;
            opacity: 0.3'>
        </a-entity>

        <!-- Fireplace -->
        <a-entity position='0 -1 -1.5'>
            <!-- Light inside the fireplace -->
            <a-light type='point' color='orange' intensity='1' decay='4' distance='3' position='0 -0.5 0'></a-light>
            <!-- Light glowing outside the fireplace -->
            <a-light id='flicker-light' type='point' color='orange' intensity='2' decay='4' distance='10' position='0 -0.5 1'>
                <a-animation
                    from='2'
                    to='2.3'
                    dur=200
                    direction='alternate'
                    repeat='indefinite'
                    attribute='intensity'>
                </a-animation>
            </a-light>

            <!-- A second light glowing outside the fireplace animating at a different interval
                 to create the illusion of random flickering -->
            <a-light id='flicker-light-2' type='point' color='orange' intensity='2' decay='2' distance='10' position='0 -0.5 1'>
                <a-animation
                    from='0.5'
                    to='1'
                    dur=1250
                    direction='alternate'
                    repeat='indefinite'
                    attribute='intensity'>
                </a-animation>
            </a-light>

            <!-- Fireplace -->
            <a-obj-model mixin='stone-material' src='#fireplace-obj' scale='0.001 0.001 0.001' position='0 0.4 -0.5'></a-obj-model>

            <!-- Fire -->
            <!-- Note we must use non zero values in all vec3's otherwise defaults kick in,
                 so use very low values if we want to 'zero' something
                 https://github.com/IdeaSpaceVR/aframe-particle-system-component/issues/13 -->
            <a-entity id='fire'
                sound='src: #fire-audio; autoplay: true; loop: true; volume: 0.5'
                position='0 -0.7 -0.2'
                scale='0.7 0.1 0.1'
                particle-system='texture: #flame-texture;
                color: #ccccff,#ff1100,#ffff00,#ffff00,#ff0000,#ff0000;
                positionSpread: 1 2 3;
                velocityValue: 0.1 2 0.01;
                velocitySpread: 1 10 0.01;
                accelerationValue: 0.1 5 0.1;
                accelerationSpread: 0.1 5 1;
                maxAge: 0.5;
                size: 0.2;
                particleCount: 1000;
                opacity: 0.1'>
            </a-entity>

            <!-- Logs -->
            <a-entity position='-0.3 -0.68 -0.3'>
                <a-obj-model mixin='log-mixin' src='#log-obj' position='0 -0.05 0.11' rotation='-66 156 101'></a-obj-model>
                <a-obj-model mixin='log-mixin' src='#log-obj' position='0.06 0.04 0' rotation='-60 168 125'></a-obj-model>
                <a-obj-model mixin='log-mixin' src='#log-obj' position='0.3 0.1 -0.1' rotation='-66 87 141'></a-obj-model>
            </a-entity>
        </a-entity>

        <!-- Extra Logs in Corner -->
        <a-entity position='1.70 -1.89 -1.94' rotation='0 -148 0'>
            <a-obj-model mixin='log-mixin' src='#log-obj' position='0 -0.05 0' rotation='-66 156 101'></a-obj-model>
            <a-obj-model mixin='log-mixin' src='#log-obj' position='0.06 0.04 0' rotation='-60 168 125'></a-obj-model>
            <a-obj-model mixin='log-mixin' src='#log-obj' position='0.3 0.1 -0.1' rotation='-66 87 141'></a-obj-model>
        </a-entity>

        <!-- Room -->
        <a-entity position='0 0 0' scale='2 2 2'>
            <!-- Left Wall Pieces -->
            <a-plane mixin='wall' position='-1 0 1' rotation='0 90 0'></a-plane>
            <a-plane mixin='wall' position='-1 -1.3 -1' rotation='0 90 0'></a-plane>
            <!-- Setting scale here should override the mixin, but doesn't, so just apply material manually -->
            <a-plane position='-1 0.16 -1.65' scale='2 0.92 2' rotation='0 90 0'
                material='src: #wood; normalMap: #wood-normal; roughness: 1; metalness: 0, normalScale: 2 2'></a-plane>
            <a-plane mixin='wall' position='-1 1.6 -1' rotation='0 90 0'></a-plane>

            <a-plane mixin='wall' position='0 0 2' rotation='0 180 180'></a-plane>
            <a-plane mixin='wall' position='1 0 0' rotation='0 270 0'></a-plane>
            <a-plane mixin='wall' position='1 0 2' rotation='0 270 0'></a-plane>
            <a-plane mixin='wall' position='0 0 -1' rotation='0 0 0'></a-plane>
            <a-plane mixin='wall' position='0 1 0' rotation='90 0 0'></a-plane>
            <a-plane mixin='wall' position='0 1 2' rotation='90 0 0'></a-plane>
            <a-plane mixin='wall' position='0 -1 0' rotation='270 0 0'></a-plane>
            <a-plane mixin='wall' position='0 -1 2' rotation='270 0 0'></a-plane>
        </a-entity>
    </a-scene>
  </body>
</html>
